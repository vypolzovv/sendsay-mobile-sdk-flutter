---
title: Data flushing
excerpt: Learn how the Flutter SDK uploads data to the Sendsay API and how to customize this behavior
slug: flutter-sdk-data-flushing
categorySlug: integrations
parentDocSlug: flutter-sdk-setup
---

## Выгрузка данных

SDK кэширует данные (сессии, события, параметры клиентов и т.д.) во внутренней базе данных и периодически отправляет их в CDP Sendsay. После загрузки данных значения в веб-приложении Sendsay обновляются, а кэшированные данные удаляются из внутренней базы данных SDK. Этот процесс называется **выгрузкой данных**.

По умолчанию SDK автоматически выгружает данные, как только они отслеживаются или когда приложение переходит в фоновый режим. Вы можете настроить [режим выгрузки](#режимы-выгрузки), чтобы адаптировать это поведение к своим потребностям.

Вы также можете полностью отключить автоматическую выгрузку. В этом случае вам необходимо [выполнять выгрузку вручную](#ручная-выгрузка) каждый раз, когда появляются данные для этого.

SDK будет очищать данные только при стабильном сетевом соединении устройства. Если во время выгрузки произойдет ошибка соединения, данные будут храниться в кэше до тех пор, пока соединение не станет стабильным и данные не будут успешно выгружены.

## Режимы выгрузки

SDK поддерживает следующие 4 режима выгрузки (определенные в [`/lib/src/data/model/flush_mode.dart`](https://github.com/sendsay-ru/sendsay-mobile-sdk-flutter/blob/main/lib/src/data/model/flush_mode.dart)), чтобы указать, выгружаются ли данные автоматически или как часто.

| Название                            | Описание |
| ------------------------------ - | ----------- |
| `FlushMode.immediate` (по умолчанию) | Немедленно выгружает все данные по мере их получения. |
| `FlushMode.period`              | Выгружает данные с интервалом, указанным с помощью `setFlushPeriod(Duration)`, а также при закрытии приложения или переходе в фоновый режим. |
| `FlushMode.appClose`            | Выгружает данные при каждом выходе приложения из активного состояния. |
| `FlushMode.manual`              | Отключает любую автоматическую загрузку. Ответственность за [ручную выгрузку данных](#ручная-выгрузка) несет разработчик. |

Чтобы установить режим выгрузки, сначала [инициализируйте SDK](../docs/setup.md), а затем вызовите метод `setFlushMode()` с желаемым режимом в качестве параметра:

```dart
SendsayPlugin().setFlushMode(FlushMode.manual);
```

При использовании режима выгрузки `FlushMode.period` интервал по умолчанию составляет 60 минут. Чтобы указать другой интервал, вызовите метод `setFlushPeriod()` с параметром `Duration`:

```dart
SendsayPlugin().setFlushMode(FlushMode.period);
final period = Duration(minutes: 5);
SendsayPlugin().setFlushPeriod(period);
```

## Ручная выгрузка

Чтобы вручную запустить выгрузку данных, используйте следующий метод:

```dart
SendsayPlugin().flushData();
```
